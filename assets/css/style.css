/* === [1. 湲곕낯 ?ㅼ젙] === */
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      -webkit-font-smoothing: antialiased;
      user-select: none; -webkit-user-select: none;
      -webkit-touch-callout: none;
      touch-action: none; /* 釉뚮씪?곗? 湲곕낯 ?쒖뒪泥?李⑤떒 */
    }

    html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      /* iOS Safari?먯꽌 二쇱냼李??④? ?쒖뿉???꾩껜 ?붾㈃ 梨꾩슦湲?*/
      height: -webkit-fill-available;
      overflow: hidden;
    }

    body {
      margin: 0;
      padding: 0;
      background-color: #050505;
      background-image: radial-gradient(ellipse at center, #2c3e50 0%, #050505 60%);
      color: white;
      /* 紐⑤컮?쇱뿉???꾩껜 ?붾㈃ 梨꾩슦湲?*/
      min-height: 100vh;
      min-height: -webkit-fill-available;
      overflow: hidden;
      width: 100vw;
      height: 100vh;
      display: flex; align-items: center; justify-content: center;
    }

    .numeric-val { font-variant-numeric: tabular-nums; font-weight: 700; }

    #game-container {
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background: #050505;
    }

    /* Aspect-fit surface that stays centered and letterboxed if needed */
    #game-surface {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #111;
      box-shadow: 0 10px 60px rgba(0, 0, 0, 0.9);
      overflow: hidden;
      z-index: 0;
    }

    canvas { display: block; width: 100%; height: 100%; }
    #gameCanvas { position: relative; z-index: 1; }

    #game-surface::after {
      content: '';
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 2;
      opacity: 0.12;
      background: repeating-linear-gradient(
        0deg,
        rgba(255, 255, 255, 0.04),
        rgba(255, 255, 255, 0.04) 1px,
        rgba(0, 0, 0, 0.08) 1px,
        rgba(0, 0, 0, 0.08) 3px
      );
    }

    /* === [紐⑤컮??而⑦듃濡ㅻ윭 (?꾩껜 ?붾㈃ ??컻)] === */
    #mobile-controls {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      z-index: 50; display: flex;
      /* 泥섏쓬???④? (硫붾돱 ?붾㈃) */
      display: none; 
    }

    /* ?쇱そ: ?대룞 議곗씠?ㅽ떛 援ъ뿭 */
    #joystick-zone {
      width: 50%; height: 100%; 
      position: relative; 
    }
    
    /* 議곗씠?ㅽ떛 UI */
    #joystick-base {
      width: 120px; height: 120px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      position: absolute;
      display: none; /* 湲곕낯: PC?먯꽌???④?, ?곗튂 湲곌린 anchor??JS?먯꽌 ?쒖뼱 */
      opacity: 0.35;
      transition: opacity 0.15s, background 0.15s, border-color 0.15s, transform 0.15s;
      pointer-events: none; /* ?곗튂 ?대깽?몃뒗 zone??諛쏆쓬 */
    }
    #joystick-base.active{
      opacity: 0.95;
      background: rgba(255, 255, 255, 0.16);
      border-color: rgba(255, 255, 255, 0.5);
      transform: scale(1.02);
    }
    
    #joystick-stick {
      width: 50px; height: 50px;
      background: rgba(241, 196, 15, 0.9);
      border-radius: 50%;
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 15px rgba(241, 196, 15, 0.6);
      opacity: 0.45;
      transition: opacity 0.12s, box-shadow 0.12s;
    }
    #joystick-stick.active{
      opacity: 1;
      box-shadow: 0 0 20px rgba(241, 196, 15, 0.85);
    }

    /* ?ㅻⅨ履? ???援ъ뿭 */
    #dash-zone {
      width: 50%; height: 100%; 
      position: relative;
      display: flex; align-items: flex-end; justify-content: flex-end; 
      /* Safe Area: Add padding to the bottom and right */
      padding: 40px calc(40px + env(safe-area-inset-right, 0px)) calc(100px + env(safe-area-inset-bottom, 0px)) 40px;
    }

    #btn-dash-visual {
      width: 90px;
      height: 90px;
      border-radius: 50%;
      background: rgba(0, 20, 0, 0.5);
      border: 3px solid #00ff41;
      color: #00ff41;
      font-weight: 900;
      font-size: 16px;
      letter-spacing: 2px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 2px;
      position: relative;
      box-shadow:
        0 0 15px rgba(0, 255, 65, 0.6),
        0 0 30px rgba(0, 255, 65, 0.4),
        inset 0 0 20px rgba(0, 255, 65, 0.15);
      text-shadow: 0 0 10px #00ff41, 0 0 20px #00ff41;
      pointer-events: none;
      transition: all 0.1s;
      overflow: visible;
    }
    /* Dash button label - ?뺤쨷???뺣젹 */
    #dash-label {
      display: block;
      text-align: center;
      line-height: 1;
      z-index: 2;
    }
    /* Scanlines inside dash button */
    #btn-dash-visual::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.1) 2px,
        rgba(0, 0, 0, 0.1) 4px
      );
      pointer-events: none;
    }
    /* ?곗튂 ??湲由ъ튂 諛섏쓳 */
    #dash-zone.active #btn-dash-visual {
      background: rgba(0, 255, 65, 0.15);
      transform: scale(0.95);
      animation: dashGlitch 0.2s ease-out;
    }
    @keyframes dashGlitch {
      0% { transform: scale(0.95); filter: hue-rotate(0deg); }
      25% { transform: scale(0.95) translateX(-2px) skewX(-3deg); filter: hue-rotate(60deg); text-shadow: -2px 0 #ff0040, 2px 0 #00d4ff; }
      50% { transform: scale(0.95) translateX(2px) skewX(2deg); filter: hue-rotate(-60deg); text-shadow: 2px 0 #ff0040, -2px 0 #00d4ff; }
      75% { transform: scale(0.95) translateX(-1px); filter: hue-rotate(30deg); }
      100% { transform: scale(0.95); filter: hue-rotate(0deg); text-shadow: 0 0 10px #00ff41, 0 0 20px #00ff41; }
    }

    /* DASH 荑⑦????쒖떆 */
    #dash-cooldown-text{
      font-size: 12px;
      font-weight: 900;
      line-height: 1;
      font-variant-numeric: tabular-nums;
      opacity: 0.9;
      display: none;
      color: inherit;
      text-shadow: inherit;
      text-align: center;
    }
    #btn-dash-visual.not-ready {
      opacity: 0.4;
      border-color: rgba(0, 255, 65, 0.3);
      box-shadow:
        0 0 5px rgba(0, 255, 65, 0.2),
        inset 0 0 10px rgba(0, 255, 65, 0.05);
      text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
    }
    #btn-dash-visual.not-ready #dash-cooldown-text{
      display: block;
    }

    /* [JFB v2] WAIT Phase - ?뚯깋/?몃???寃쎄퀬 */
    #btn-dash-visual.boost-wait {
      background: linear-gradient(135deg, #7f8c8d 0%, #95a5a6 50%, #bdc3c7 100%);
      border: 3px solid rgba(241, 196, 15, 0.7);
      color: #f1c40f;
      box-shadow: 0 0 15px rgba(241, 196, 15, 0.3);
      animation: boost-wait-pulse 0.8s ease-in-out infinite;
      opacity: 1 !important;
      filter: none !important;
    }
    /* boost-wait??JS?먯꽌 ?띿뒪??泥섎━ - ::after ?쒓굅 */
    @keyframes boost-wait-pulse {
      0%, 100% { transform: scale(1); box-shadow: 0 0 15px rgba(241, 196, 15, 0.3); }
      50% { transform: scale(1.02); box-shadow: 0 0 25px rgba(241, 196, 15, 0.5); }
    }
    #dash-zone.active #btn-dash-visual.boost-wait {
      background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
      transform: scale(0.92);
      animation: none;
    }

    /* [JFB v2] ACTIVE Phase - 媛뺣젹??Cyan, ?ш린 ?뺣?, 湲濡쒖슦 */
    #btn-dash-visual.boost-active {
      background: linear-gradient(135deg, #00ffff 0%, #00e5ff 30%, #00bcd4 60%, #0097a7 100%);
      border: 4px solid rgba(0, 255, 255, 1);
      color: #ffffff;
      box-shadow:
        0 0 30px rgba(0, 255, 255, 0.9),
        0 0 60px rgba(0, 229, 255, 0.7),
        0 0 100px rgba(0, 188, 212, 0.5),
        inset 0 0 20px rgba(255, 255, 255, 0.3);
      animation: boost-active-pulse 0.15s ease-in-out infinite;
      opacity: 1 !important;
      filter: none !important;
      transform: scale(1.15);
      font-size: 14px;
      font-weight: 900;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }
    /* boost-active??JS?먯꽌 ?띿뒪??泥섎━ - ::after ?쒓굅 */
    @keyframes boost-active-pulse {
      0%, 100% {
        transform: scale(1.15);
        box-shadow: 0 0 30px rgba(0, 255, 255, 0.9), 0 0 60px rgba(0, 229, 255, 0.7);
      }
      50% {
        transform: scale(1.20);
        box-shadow: 0 0 50px rgba(0, 255, 255, 1), 0 0 100px rgba(0, 229, 255, 0.9);
      }
    }
    @keyframes active-text-flash {
      from { opacity: 0.7; }
      to { opacity: 1; }
    }
    #dash-zone.active #btn-dash-visual.boost-active {
      background: linear-gradient(135deg, #0097a7 0%, #00ffff 100%);
      transform: scale(1.0);
      animation: none;
    }

    /* ?좎뒪??吏㏃? ?쇰뱶諛? */
    #toast-msg{
      position: absolute;
      top: 220px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 14px;
      border-radius: 16px;
      background: rgba(0,0,0,0.72);
      border: 1px solid rgba(255,255,255,0.12);
      font-weight: 900;
      font-size: 13px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.15s, transform 0.15s;
      z-index: 80;
      white-space: nowrap;
      text-shadow: 0 1px 2px rgba(0,0,0,0.6);
    }
    #toast-msg.show{
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    #toast-msg.level-warn{ border-color: rgba(241, 196, 15, 0.5); }
    #toast-msg.level-danger{ border-color: rgba(231, 76, 60, 0.6); }
    /* ?곹깭蹂?而⑦뀒?대꼫 媛뺤“ */
    #game-container.state-stop,
    #game-surface.state-stop{ box-shadow: 0 0 60px rgba(231, 76, 60, 0.35); }
    #game-container.state-warning,
    #game-surface.state-warning{ box-shadow: 0 0 60px rgba(241, 196, 15, 0.25); }

    /* === [HUD UI] === */
    #hud {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 60;
    }

    /* HUD ?꾩씠肄?怨듯넻 */
    .hud-icon {
      width: 24px; height: 24px; object-fit: contain;
    }

    /* 醫뚯륫 ?곷떒: ?먯닔/肄붿씤/蹂댁꽍 */
    .hud-left {
      position: absolute;
      /* Safe Area: Notch ???*/
      top: calc(20px + env(safe-area-inset-top, 0px));
      left: calc(20px + env(safe-area-inset-left, 0px));
      display: flex; flex-direction: column; gap: 12px; align-items: flex-start;
    }

    .score-pill {
      background: rgba(0,0,0,0.9); /* darker to replace removed blur */
      padding: 8px 12px;
      border-radius: 25px;
      font-weight: 700;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 10px;
      border: 2px solid rgba(255,255,255,0.3);
      min-width: 80px;
      line-height: 1;
    }

    .score-pill .numeric-val {
      display: flex;
      align-items: center;
      line-height: 1;
    }

    .score-pill.score-main {
      border-color: rgba(121, 245, 102, 0.5);
    }

    .score-green {
      color: #79F566;
      text-shadow: 0 0 8px rgba(121, 245, 102, 0.5);
      font-size: 22px;
      line-height: 1;
    }

    /* ?듯솕 ?꾩씠肄??ㅽ???*/
    .currency-icon {
      width: 24px;
      height: 24px;
      object-fit: contain;
      vertical-align: middle;
    }

    .currency-icon-sm {
      width: 18px;
      height: 18px;
      object-fit: contain;
      vertical-align: middle;
    }

    .currency-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .result-stat {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* 湲곗〈 score-display (?④? 泥섎━?? */
    .score-display {
      display: none;
    }

    /* === [NEW] 踰꾪봽 ?꾩씠肄?而⑦뀒?대꼫 (?먰삎 ?꾩씠肄? === */
    #buff-container {
      position: absolute;
      top: 200px;
      /* Safe Area: Notch ???*/
      left: calc(20px + env(safe-area-inset-left, 0px));
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .buff-icon {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      display: none; /* 湲곕낯 ?④? - ?쒖꽦?????쒖떆 */
      justify-content: center;
      align-items: center;
      border: 2px solid rgba(255,255,255,0.25);
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
      animation: buff-pop-in 0.3s ease-out;
      transition: opacity 0.2s, transform 0.2s;
    }

    .buff-icon.active {
      display: flex;
    }

    .buff-icon img {
      width: 28px;
      height: 28px;
      object-fit: contain;
    }

    #buff-barrier { background: rgba(52, 152, 219, 0.85); }
    #buff-booster { background: rgba(231, 76, 60, 0.85); }
    #buff-magnet { background: rgba(160, 76, 199, 0.85); }

    /* 踰꾪봽 留뚮즺 寃쎄퀬 源쒕묀??*/
    .buff-icon.expiring {
      animation: buff-blink 0.3s infinite alternate;
    }

    .buff-icon.expiring-fast {
      animation: buff-blink-fast 0.15s infinite alternate;
    }

    @keyframes buff-pop-in {
      from { transform: scale(0.5); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    @keyframes buff-blink {
      from { opacity: 1; }
      to { opacity: 0.4; }
    }

    @keyframes buff-blink-fast {
      from { opacity: 1; }
      to { opacity: 0.2; }
    }

    /* === [NEW] 以묒븰 ?곷떒: ?됱긽 ?⑤꼸 === */
    #target-display {
      position: absolute;
      /* Safe Area: Notch ???*/
      top: calc(26px + env(safe-area-inset-top, 0px));
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 120px;
      border: 6px solid rgba(255,255,255,0.4);
      border-radius: 12px;
      background-color: #222;
      box-shadow: 0 5px 25px rgba(0,0,0,0.5);
      transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s;
    }

    #countdown-text {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Roboto', sans-serif; /* Changed font family */
      font-weight: 900;
      color: white;
      font-variant-numeric: tabular-nums;
      position: relative;
      top: -2px;
    }
    #countdown-text.countdown-is-number {
      font-size: 52px; /* Original large size for numbers */
    }
    #countdown-text.countdown-is-text {
      font-size: 32px; /* Slightly smaller size for text (GO/STOP) */
    }


    /* === [NEW] ?곹깭 諛?而⑦뀒?대꼫 (以묒븰) === */
    #status-bar-container {
      position: absolute;
      /* Safe Area: Notch ???(target-display ?꾨옒???꾩튂?섎?濡?媛꾧꺽 議곗젙) */
      top: calc(160px + env(safe-area-inset-top, 0px));
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    #status-bar-container #phase-bar {
      position: relative;
      top: auto;
      left: auto;
      transform: none;
      width: 120px;
    }

    #status-bar-container #status-msg {
      position: relative;
      top: auto;
      left: auto;
      transform: none;
    }

    #status-msg {
      width: auto;
      height: auto;
      padding: 6px 14px;
      border-radius: 8px;
      background: rgba(0,0,0,0.9); /* darker to replace removed blur */
      border: 1px solid rgba(255,255,255,0.10);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 14px;
      font-weight: 900;
      text-shadow: 0 2px 4px rgba(0,0,0,0.75);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      pointer-events: none;
    }

    /* === [NEW] ?곗륫 ?곷떒: ?쇱떆?뺤? 踰꾪듉 === */
    .hud-pause-btn {
      position: absolute;
      /* Safe Area: Notch ???*/
      top: calc(20px + env(safe-area-inset-top, 0px));
      right: calc(20px + env(safe-area-inset-right, 0px));
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: rgba(0,0,0,0.55);
      border: none;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: auto;
      z-index: 100;
    }

    .hud-pause-btn:active {
      background: rgba(255,255,255,0.2);
    }

    .pause-icon {
      display: flex;
      gap: 4px;
    }

    .pause-icon::before,
    .pause-icon::after {
      content: '';
      width: 5px;
      height: 18px;
      background: #D9D9D9;
      border-radius: 2px;
    }

    /* === [NEW] ?곗륫: ?ㅽ뀒?댁? 寃뚯씠吏 諛?=== */
    #chase-ui {
      position: absolute;
      /* Safe Area: Notch and side-screen compatibility */
      top: calc(79px + env(safe-area-inset-top, 0px));
      right: max(34px, env(safe-area-inset-right, 14px));
      width: 12px;
      height: 240px; /* 珥?湲몄씠 240px */
    }

    #chase-bar {
      position: relative;
      width: 12px;
      height: 100%;
      background: rgba(0,0,0,0.18);
      border: 2px solid rgba(255,255,255,0.15);
      border-radius: 6px;
      overflow: visible;
    }

    /* 寃뚯씠吏 怨듯넻 ?ㅽ???*/
    .chase-gauge {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 8px;
      height: 0%;
      border-radius: 4px;
      transition: height 0.15s linear;
    }

    /* ?뚮젅?댁뼱 寃뚯씠吏 (?섎떒 ?덉씠?? */
    .player-gauge {
      background: linear-gradient(to top, #DCFF89 0%, rgba(220, 255, 137, 0.6) 100%);
      z-index: 5;
    }

    /* ?ㅽ넱 寃뚯씠吏 (?곷떒 ?덉씠??- ?뚮젅?댁뼱瑜?媛由? */
    .storm-gauge {
      background: linear-gradient(to top, #FF465F 0%, rgba(255, 70, 95, 0.5) 100%);
      z-index: 10;
    }

    /* ? 留덉빱 怨듯넻 */
    .chase-pin {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 32px;
      height: 32px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 15;
    }

    .chase-pin img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
    }

    /* ?ㅽ넱 ?? ???믪? z-index */
    .storm-gauge .chase-pin {
      z-index: 20;
    }

    /* ?꾪뿕 紐⑤뱶 (?ㅽ넱??媛源뚯슱 ?? */
    #chase-ui.danger-mode #chase-bar {
      border-color: #e74c3c;
      box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
    }

    #chase-ui.danger-mode .storm-gauge {
      animation: storm-pulse 0.4s infinite alternate;
    }

    @keyframes storm-pulse {
      from { opacity: 0.8; }
      to { opacity: 1; }
    }

    /* ?곷떒 ?④퀎 ??대㉧ 諛?- 而⑦뀒?대꼫 ?대???*/
    #phase-bar {
      height: 14px;
      background: rgba(255,255,255,0.12);
      border: 2px solid rgba(255,255,255,0.18);
      border-radius: 999px;
      overflow: hidden;
      pointer-events: none;
    }

    #phase-bar-fill {
      height: 100%;
      width: 100%;
      background: rgba(46, 204, 113, 0.75);
      transform-origin: left center;
      transform: scaleX(1);
      transition: transform 0.08s linear, background 0.2s;
    }

    #theme-notify {
      position: absolute; top: 35%; left: 50%; transform: translate(-50%, -50%);
      font-size: 42px; font-weight: 900; color: #fff; opacity: 0; pointer-events: none;
      transition: opacity 0.5s; z-index: 50; text-align: center; width: 100%;
      text-shadow: 0 0 20px rgba(0,0,0,0.8);
    }
    #storm-warning {
      position: absolute; bottom: 180px; left: 0; width: 100%; text-align: center;
      color: #ff3838; font-weight: 900; font-size: 20px;
      animation: blink 0.4s infinite alternate; display: none; pointer-events: none;
    }
    @keyframes blink { from { opacity: 0.3; } to { opacity: 1; } }

    /* === [硫붾돱 & ?곸젏] === */
    #menu-screen {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(10, 10, 15, 0.98); display: flex; flex-direction: column; /* no blur */
      align-items: center; justify-content: flex-start; z-index: 100;
      /* 紐⑤컮???ㅽ겕濡??덉슜 */
      overflow-y: auto;
      touch-action: pan-y;
      -webkit-overflow-scrolling: touch;
      padding: 40px 0;
    }
    /* 硫붾돱 ?대? ?붿냼?ㅻ룄 ?ㅽ겕濡??쒖뒪泥섎? 留됱? ?딄쾶 ?ㅼ젙 */
    #menu-screen * {
      touch-action: pan-y;
    }
    .currency-row {
      display: flex; justify-content: center; gap: 25px; margin-bottom: 20px;
      background: rgba(255,255,255,0.05); padding: 12px 30px; border-radius: 40px; border: 1px solid rgba(255,255,255,0.1);
    }
    .currency-item { font-size: 20px; font-weight: 800; display: flex; align-items: center; gap: 8px; }

    .result-card {
      width: 85%;
      background: linear-gradient(145deg, rgba(46, 204, 113, 0.08), rgba(52, 152, 219, 0.08));
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 18px;
      box-shadow: 0 8px 28px rgba(0,0,0,0.35);
    }
    .result-total-row {
      display: flex; justify-content: space-between; align-items: center;
      font-size: 18px; font-weight: 900; margin-bottom: 6px;
    }
    .result-title { color: #2ecc71; letter-spacing: 0.5px; }
    .result-high-row {
      display: flex; gap: 10px; align-items: center;
      font-weight: 800; color: #bdc3c7; margin-bottom: 10px;
    }
    .badge-new {
      background: linear-gradient(90deg, #f1c40f, #e67e22);
      color: #000;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 900;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
    }
    .result-detail { display: flex; flex-direction: column; gap: 6px; margin-bottom: 10px; }
    .detail-row { display: flex; justify-content: space-between; font-weight: 800; color: #ecf0f1; }
    .result-currency-row {
      display: flex; gap: 14px; flex-wrap: wrap;
      font-weight: 800; color: #ecf0f1;
      background: rgba(0,0,0,0.25);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 12px;
      padding: 8px 10px;
    }

    .tab-container {
      display: flex;
      gap: 5px;
      margin-bottom: 0;
      width: 85%;
      flex-shrink: 0;
    }
    .tab-btn {
      background: linear-gradient(135deg, #0a1f0a 0%, #1a3a1a 100%);
      border: 1px solid rgba(0, 255, 65, 0.3);
      color: rgba(0, 255, 65, 0.6);
      padding: 12px 0;
      border-radius: 12px 12px 0 0;
      cursor: pointer;
      font-weight: bold;
      flex: 1;
      text-align: center;
      font-size: 14px;
      transition: all 0.2s;
    }
    .tab-btn:hover {
      color: #00ff41;
      border-color: rgba(0, 255, 65, 0.5);
    }
    .tab-btn.active {
      background: linear-gradient(135deg, #0a2f0a 0%, #1a4a1a 100%);
      color: #00ff41;
      border-color: #00ff41;
      border-bottom: 2px solid #00ff41;
      text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
    }

    .shop-content {
      width: 85%;
      background: linear-gradient(135deg, rgba(10, 31, 10, 0.9) 0%, rgba(26, 58, 26, 0.9) 100%);
      border-radius: 0 0 15px 15px;
      padding: 20px;
      margin-bottom: 12px;
      border: 1px solid rgba(0, 255, 65, 0.3);
      box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
      flex: 1;
      min-height: 0;
      max-height: none;
      overflow-y: auto;
      overflow-x: hidden;
      box-sizing: border-box;
    }

    .qa-content {
      width: 85%;
      background: linear-gradient(135deg, rgba(10, 31, 10, 0.9) 0%, rgba(26, 58, 26, 0.9) 100%);
      border-radius: 0 0 15px 15px;
      padding: 20px;
      margin-bottom: 25px;
      border: 1px solid rgba(0, 255, 65, 0.3);
      box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
      flex: 1;
      min-height: 0;
      max-height: none;
      overflow-y: auto;
      overflow-x: hidden;
      box-sizing: border-box;
    }

    /* === [紐⑤컮???ㅽ겕濡??덉슜] ===
       ?곗튂 ?쒕옒洹몃줈 ?ㅽ겕濡?媛?ν븯?꾨줉 ?ㅼ젙
    */
    .shop-content,
    .qa-content {
      touch-action: pan-y !important;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
    }
    /* ?대? ?붿냼???ㅽ겕濡??꾪뙆 ?덉슜 */
    .shop-content > *,
    .qa-content > * {
      touch-action: pan-y !important;
    }
    /* 踰꾪듉/?щ씪?대뜑 ???명꽣?숉떚釉??붿냼??紐⑤뱺 ?곗튂 ?덉슜 */
    .shop-content button,
    .shop-content input,
    .qa-content button,
    .qa-content input {
      touch-action: manipulation !important;
    }

    .shop-content::-webkit-scrollbar { width: 6px; }
    .shop-content::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 65, 0.4);
      border-radius: 3px;
    }
    .shop-content::-webkit-scrollbar-track {
      background: rgba(0, 255, 65, 0.1);
    }
    .qa-content::-webkit-scrollbar { width: 6px; }
    .qa-content::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 65, 0.4);
      border-radius: 3px;
    }
    .qa-content::-webkit-scrollbar-track {
      background: rgba(0, 255, 65, 0.1);
    }

    /* ?꾩씠??怨듯넻 ?ㅽ???- cyber theme */
    .upgrade-item, .setting-item, .skin-list-item {
      background: rgba(0, 255, 65, 0.05);
      padding: 14px;
      margin-bottom: 10px;
      border-radius: 12px;
      border: 1px solid rgba(0, 255, 65, 0.15);
      box-sizing: border-box;
      transition: all 0.2s;
    }
    .upgrade-item:hover, .skin-list-item:hover {
      background: rgba(0, 255, 65, 0.1);
      border-color: rgba(0, 255, 65, 0.3);
    }
    .upgrade-item { display: flex; justify-content: space-between; align-items: center; }
    .qa-group .setting-item {
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
      padding: 12px 16px;
      background: rgba(0, 255, 65, 0.05);
      border: 1px solid rgba(0, 255, 65, 0.15);
    }
    .upgrade-name {
      font-size: 15px;
      font-weight: 800;
      display: block;
      color: #00ff41;
      margin-bottom: 4px;
      text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
    }
    .stat-preview {
      font-size: 12px;
      color: #00cc33;
      margin-top: 4px;
      display: block;
      font-weight: 600;
    }

    .btn-common, .btn-buy {
      border: none;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 900;
      font-size: 13px;
      cursor: pointer;
      color: #000;
      box-shadow: 0 3px 0 rgba(0, 100, 30, 0.5), 0 0 15px rgba(0, 255, 65, 0.3);
      transition: all 0.1s;
    }
    .btn-common {
      background: linear-gradient(135deg, #00cc33 0%, #00ff41 50%, #00cc33 100%);
      color: #000;
      min-width: 80px;
      font-size: 14px;
    }
    .btn-common:hover {
      box-shadow: 0 3px 0 rgba(0, 100, 30, 0.5), 0 0 25px rgba(0, 255, 65, 0.5);
    }
    .btn-buy { flex: 1; display: flex; align-items: center; justify-content: center; gap: 4px; }
    .btn-common:active, .btn-buy:active { transform: translateY(2px); box-shadow: none; }
    .btn-common.disabled, .btn-coin.locked {
      background: #1a3a1a;
      color: #4a6a4a;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* ?ㅽ궓 由ъ뒪??- cyber theme */
    .skin-list-item {
      display: flex;
      flex-direction: column;
      gap: 8px;
      border: 2px solid rgba(0, 255, 65, 0.2);
    }
    .skin-list-item.equipped {
      border-color: #00ff41;
      background: rgba(0, 255, 65, 0.15);
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
    }
    .skin-header { display: flex; align-items: center; justify-content: space-between; }
    .skin-info-left { display: flex; align-items: center; gap: 10px; }
    .skin-preview {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: 2px solid rgba(0, 255, 65, 0.4);
      box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
    }
    .skin-details { display: flex; flex-direction: column; }
    .skin-name {
      font-size: 15px;
      font-weight: 800;
      color: #ecf0f1;
    }
    .skin-rarity { font-size: 11px; font-weight: 800; text-transform: uppercase; margin-top: 2px; }
    .skin-desc { font-size: 12px; color: #8fbc8f; font-weight: 500; margin: 4px 0; }
    .skin-actions { display: flex; gap: 6px; width: 100%; }

    .rarity-Common { color: #b2bec3; }
    .rarity-Rare { color: #3498db; }
    .rarity-Epic { color: #9b59b6; }
    .rarity-Unique { color: #e67e22; }
    .rarity-Legendary { color: #f1c40f; text-shadow: 0 0 5px rgba(241, 196, 15, 0.5); }
    .rarity-Mystic { color: #e74c3c; text-shadow: 0 0 8px rgba(231, 76, 60, 0.7); animation: mystic-pulse 1s infinite alternate; }
    @keyframes mystic-pulse { from{opacity:0.8;} to{opacity:1;} }

    .btn-coin {
      background: linear-gradient(135deg, #00cc33 0%, #00ff41 100%);
    }
    .btn-gem {
      background: linear-gradient(135deg, #6a1b9a 0%, #9c27b0 100%);
      box-shadow: 0 3px 0 rgba(80, 20, 100, 0.5), 0 0 15px rgba(156, 39, 176, 0.3);
    }
    .btn-equip {
      background: linear-gradient(135deg, #00aa33 0%, #00cc44 100%);
      width: 100%;
    }
    .btn-equipped {
      background: #0a1f0a;
      color: #4a6a4a;
      cursor: default;
      width: 100%;
      box-shadow: none;
      border: 1px solid rgba(0, 255, 65, 0.2);
    }

    .start-btn {
      padding: 16px 70px;
      font-size: 26px;
      background: linear-gradient(135deg, #00cc33 0%, #00ff41 50%, #00cc33 100%);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 900;
      color: #000;
      margin-top: 15px;
      box-shadow: 0 6px 0 #009922, 0 0 30px rgba(0, 255, 65, 0.5);
    }
    .start-btn:active { transform: translateY(6px); box-shadow: none; }

    /* QA ?고듃 - cyber theme */
    .vol-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2px;
      color: #ecf0f1;
      font-weight: bold;
      font-size: 14px;
      width: 100%;
    }
    .val-display {
      color: #00ff41;
      font-size: 14px;
      font-weight: 800;
      font-variant-numeric: tabular-nums;
      text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
    }
    input[type=range] {
      width: 100%;
      accent-color: #00ff41;
      cursor: pointer;
      height: 6px;
      border-radius: 5px;
      background: rgba(0, 255, 65, 0.1);
      margin: 5px 0;
      display: block;
      border: none;
      outline: none;
    }

    /* === [NEW] ?붾㈃ ?꾪솚 ?쒖뒪??=== */
    .full-screen {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: none; flex-direction: column; align-items: center;
      background: #050505; z-index: 100;
      overflow-y: auto; touch-action: pan-y;
      -webkit-overflow-scrolling: touch; padding: 30px 0;
    }
    .full-screen.active-screen, .full-screen[style*="display: flex"] { display: flex; }
    .full-screen * { touch-action: pan-y; }

    /* === [NEW] TITLE SCREEN === */
    #screen-title {
      justify-content: center; padding: 0;
      background: linear-gradient(135deg, #020a02 0%, #0a1f0a 50%, #051005 100%);
      overflow: hidden;
    }
    /* Cyber grid background */
    #screen-title::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background:
        linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px),
        linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      animation: gridMove 20s linear infinite;
      pointer-events: none;
    }
    @keyframes gridMove {
      0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
      100% { transform: perspective(500px) rotateX(60deg) translateY(40px); }
    }
    /* Scanline overlay */
    #screen-title::after {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.15) 2px,
        rgba(0, 0, 0, 0.15) 4px
      );
      pointer-events: none;
      opacity: 0.4;
    }
    .title-content {
      text-align: center;
      animation: title-float 3s ease-in-out infinite;
      z-index: 1;
    }
    @keyframes title-float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-8px);} }

    /* === GLITCH LOGO === */
    .game-logo {
      font-size: 52px; font-weight: 900; color: #00ff41; margin: 0;
      text-shadow:
        0 0 10px rgba(0, 255, 65, 0.8),
        0 0 20px rgba(0, 255, 65, 0.6),
        0 0 40px rgba(0, 255, 65, 0.4),
        0 4px 0 #004d14;
      letter-spacing: -2px; font-style: italic;
      position: relative;
      animation: logoGlitch 4s ease-in-out infinite;
    }
    .game-logo .accent { color: #ff0040; text-shadow: 0 0 10px rgba(255, 0, 64, 0.8); }

    /* Glitch pseudo-elements */
    .game-logo::before,
    .game-logo::after {
      content: 'RUN & STOP';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      opacity: 0;
    }
    .game-logo::before {
      color: #ff0040;
      animation: glitchTop 4s ease-in-out infinite;
      clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
    }
    .game-logo::after {
      color: #00d4ff;
      animation: glitchBottom 4s ease-in-out infinite;
      clip-path: polygon(0 55%, 100% 55%, 100% 100%, 0 100%);
    }
    @keyframes logoGlitch {
      0%, 90%, 100% { transform: translate(0); }
      92% { transform: translate(-2px, 1px); }
      94% { transform: translate(2px, -1px); }
      96% { transform: translate(-1px, -1px); }
      98% { transform: translate(1px, 1px); }
    }
    @keyframes glitchTop {
      0%, 90%, 100% { opacity: 0; transform: translate(0); }
      92% { opacity: 0.8; transform: translate(-3px, 0); }
      94% { opacity: 0; transform: translate(3px, 0); }
      96% { opacity: 0.6; transform: translate(-2px, 0); }
      98% { opacity: 0; }
    }
            @keyframes glitchBottom {
      0%, 90%, 100% { opacity: 0; transform: translate(0); }
      91% { opacity: 0; }
      93% { opacity: 0.8; transform: translate(3px, 0); }
      95% { opacity: 0; transform: translate(-3px, 0); }
      97% { opacity: 0.6; transform: translate(2px, 0); }
      99% { opacity: 0; }
    }
    /* Lobby start button idle glitch */
        .lobby-start.glitch-idle {
      position: relative;
      overflow: hidden;
      animation: logoGlitch 4s ease-in-out infinite;
    }
    .lobby-start.glitch-idle::before,
    .lobby-start.glitch-idle::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font: inherit;
      pointer-events: none;
      opacity: 0;
    }
    .lobby-start.glitch-idle::before {
      color: #ff0040;
      animation: glitchTop 4s ease-in-out infinite;
      clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
    }
    .lobby-start.glitch-idle::after {
      color: #00d4ff;
      animation: glitchBottom 4s ease-in-out infinite;
      clip-path: polygon(0 55%, 100% 55%, 100% 100%, 0 100%);
    }


.touch-prompt {
      margin-top: 50px; font-size: 16px; color: #00ff41; font-weight: 700;
      text-transform: uppercase; letter-spacing: 3px;
      animation: promptPulse 2s ease-in-out infinite;
      text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
    }
    @keyframes promptPulse {
      0%, 100% { opacity: 0.4; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.02); }
    }

    /* === START GLITCH TRANSITION === */
    #screen-title.glitch-out {
      /* 諛곌꼍? ?좎?, ?대? 肄섑뀗痢좊쭔 ?좊땲硫붿씠??*/
    }
    #screen-title.glitch-out .title-content {
      animation: contentGlitchOut 0.6s ease-out forwards;
    }
    #screen-title.glitch-out .game-logo {
      animation: logoGlitchOut 0.6s ease-out forwards;
    }
    #screen-title.glitch-out .touch-prompt {
      animation: fadeOut 0.2s ease-out forwards;
    }
    #screen-title.glitch-out::before,
    #screen-title.glitch-out::after {
      animation: fadeOut 0.4s ease-out 0.2s forwards;
    }
    @keyframes contentGlitchOut {
      0% { opacity: 1; filter: none; }
      20% { filter: hue-rotate(90deg) saturate(2); transform: translateX(-5px); }
      40% { filter: hue-rotate(-90deg) saturate(1.5); transform: translateX(5px) skewX(-2deg); }
      60% { filter: hue-rotate(45deg); transform: translateX(-3px) skewX(1deg); }
      80% { opacity: 0.5; filter: brightness(2); }
      100% { opacity: 0; filter: brightness(3); transform: scale(1.05); }
    }
    @keyframes logoGlitchOut {
      0%, 10% { transform: translate(0); }
      20% { transform: translate(-10px, 2px) skewX(-5deg); text-shadow: 5px 0 #ff0040, -5px 0 #00d4ff; }
      30% { transform: translate(8px, -2px) skewX(3deg); }
      40% { transform: translate(-5px, 1px) skewX(-2deg); text-shadow: 3px 0 #ff0040, -3px 0 #00d4ff; }
      50% { transform: translate(3px, -1px); }
      100% { transform: translate(0) scale(1.2); opacity: 0; }
    }
    @keyframes fadeOut {
      0% { opacity: 1; }
      100% { opacity: 0; }
    }

    /* === [NEW] LOBBY SCREEN === */
    #screen-lobby {
      justify-content: space-evenly;
      padding: 20px 0 30px 0;
      background: linear-gradient(135deg, #020a02 0%, #0a1f0a 50%, #051005 100%);
      overflow: hidden;
    }
    /* Lobby cyber grid background */
    #screen-lobby::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background:
        linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px),
        linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      animation: gridMove 20s linear infinite;
      pointer-events: none;
      z-index: 0;
    }
    /* Lobby scanlines overlay */
    #screen-lobby::after {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.15) 2px,
        rgba(0, 0, 0, 0.15) 4px
      );
      pointer-events: none;
      opacity: 0.4;
      z-index: 0;
    }
    /* Lobby content above effects */
    #screen-lobby > * {
      position: relative;
      z-index: 1;
    }
    .screen-header {
      width: 100%; padding: 10px 20px; display: flex; justify-content: center; align-items: center;
    }
    .lobby-currency {
      margin: 0;
      padding: 10px 25px;
      background: rgba(0, 255, 65, 0.08);
      border: 1px solid rgba(0, 255, 65, 0.3);
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.1);
    }
    .shop-currency {
      margin: 0 0 12px;
    }
    .lobby-center { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; width: 100%; padding-top: 60px; }
    /* 臾대? 而⑦뀒?대꼫: 罹먮┃?곌? ???덉뿉?쒕쭔 ?吏곸엫 */
    .lobby-stage {
      position: relative;
      width: 100%;
      height: 160px;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      margin-bottom: 4px;
    }

    /* 罹먮┃??蹂몄껜 - cyber neon style */
    .lobby-char-box {
      position: relative;
      width: 140px; height: 140px;
      border-radius: 50%;
      background: linear-gradient(135deg, #0a1f0a 0%, #1a3a1a 100%);
      border: 3px solid #00ff41;
      box-shadow:
        0 0 20px rgba(0, 255, 65, 0.4),
        0 0 40px rgba(0, 255, 65, 0.2),
        inset 0 0 20px rgba(0, 255, 65, 0.1);
      display: flex; justify-content: center; align-items: center;
      font-size: 72px;
    }

    .lobby-char-name {
      margin-top: 5px;
      font-size: 20px;
      font-weight: 800;
      color: #00ff41;
      text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
    }
    .lobby-loadout { text-align: center; margin-top: 25px; }
    .loadout-label {
      font-size: 12px;
      font-weight: 800;
      color: #00ff41;
      margin-bottom: 10px;
      letter-spacing: 2px;
      text-shadow: 0 0 5px rgba(0, 255, 65, 0.3);
    }
    .loadout-slots { display: flex; gap: 15px; justify-content: center; }

    .lobby-slot {
      width: 70px; height: 70px; border-radius: 12px;
      background: rgba(0, 255, 65, 0.05);
      border: 2px dashed rgba(0, 255, 65, 0.3);
      display: flex; justify-content: center; align-items: center; cursor: pointer;
      transition: all 0.2s;
    }
    .lobby-slot:hover, .lobby-slot:active {
      border-color: #00ff41;
      background: rgba(0, 255, 65, 0.15);
      box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
    }
    .lobby-slot.filled {
      border-style: solid;
      border-color: #00ff41;
      background: rgba(0, 255, 65, 0.1);
      box-shadow: 0 0 10px rgba(0, 255, 65, 0.2);
    }
    .slot-icon { font-size: 28px; color: rgba(0, 255, 65, 0.4); display: flex; align-items: center; justify-content: center; }
    .slot-icon img { width: 20px; height: 20px; display: block; }
    .lobby-slot.filled .slot-icon { color: #00ff41; }
    .lobby-footer {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      padding: 0 20px;
      padding-bottom: 40px;
      width: 100%;
    }
    .lobby-start {
      position: relative;
      padding: 16px 50px;
      font-size: 20px;
      font-weight: 900;
      letter-spacing: 3px;
      text-transform: uppercase;
      background: transparent;
      color: #00ff41;
      border: 2px solid #00ff41;
      border-radius: 4px;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.15s;
      text-shadow: 0 0 10px #00ff41, 0 0 20px #00ff41;
      box-shadow:
        0 0 10px rgba(0, 255, 65, 0.5),
        0 0 30px rgba(0, 255, 65, 0.3),
        inset 0 0 20px rgba(0, 255, 65, 0.1);
    }
    .lobby-start::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.3), transparent);
      transition: left 0.5s;
    }
    .lobby-start:hover {
      background: rgba(0, 255, 65, 0.1);
      box-shadow:
        0 0 20px rgba(0, 255, 65, 0.7),
        0 0 40px rgba(0, 255, 65, 0.4),
        0 0 60px rgba(0, 255, 65, 0.2),
        inset 0 0 30px rgba(0, 255, 65, 0.15);
    }
    .lobby-start:hover::before {
      left: 100%;
    }
    .lobby-start:active {
      transform: scale(0.98);
    }
    /* Glitch effect on click */
    .lobby-start.glitch-click {
      animation: btnGlitch 0.4s ease-out;
    }
    @keyframes btnGlitch {
      0% { transform: translate(0); filter: hue-rotate(0deg); }
      10% { transform: translate(-3px, 1px) skewX(-5deg); filter: hue-rotate(90deg); }
      20% { transform: translate(3px, -1px) skewX(3deg); filter: hue-rotate(-90deg); }
      30% { transform: translate(-2px, 0) skewX(-2deg); filter: hue-rotate(45deg); }
      40% { transform: translate(2px, 1px) skewX(2deg); filter: hue-rotate(-45deg); }
      50% { transform: translate(-1px, -1px); filter: hue-rotate(0deg); }
      60% { transform: translate(1px, 0); text-shadow: -2px 0 #ff0040, 2px 0 #00d4ff; }
      70% { transform: translate(0, 1px); text-shadow: 2px 0 #ff0040, -2px 0 #00d4ff; }
      80% { transform: translate(-1px, 0); text-shadow: 0 0 10px #00ff41; }
      90% { transform: translate(1px, -1px); }
      100% { transform: translate(0); filter: hue-rotate(0deg); text-shadow: 0 0 10px #00ff41, 0 0 20px #00ff41; }
    }
    /* Scanline effect inside button */
    .lobby-start::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.1) 2px,
        rgba(0, 0, 0, 0.1) 4px
      );
      pointer-events: none;
    }
    .btn-shop-main,
    .btn-qa-main {
      padding: 12px 50px;
      font-size: 16px;
      font-weight: 900;
      border: 2px solid rgba(0, 255, 65, 0.5);
      border-radius: 30px;
      background: linear-gradient(135deg, #0a1f0a 0%, #1a3a1a 100%);
      color: #00ff41;
      cursor: pointer;
      box-shadow: 0 3px 0 #051005, 0 0 15px rgba(0, 255, 65, 0.2);
      text-shadow: 0 0 5px rgba(0, 255, 65, 0.5);
      transition: all 0.1s;
    }
    .btn-shop-main:hover,
    .btn-qa-main:hover {
      border-color: #00ff41;
      box-shadow: 0 3px 0 #051005, 0 0 25px rgba(0, 255, 65, 0.4);
    }
    .btn-shop-main:active,
    .btn-qa-main:active {
      transform: translateY(3px);
      box-shadow: none;
    }

    /* === [NEW] SHOP SCREEN - CYBER THEME === */
    #screen-shop {
      background: linear-gradient(135deg, #020a02 0%, #0a1f0a 50%, #051005 100%);
      overflow: hidden;
      justify-content: flex-start;
      padding-top: 0;
    }
    #screen-shop::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background:
        linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px),
        linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      animation: gridMove 20s linear infinite;
      pointer-events: none;
      z-index: 0;
    }
    #screen-shop::after {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.15) 2px,
        rgba(0, 0, 0, 0.15) 4px
      );
      pointer-events: none;
      opacity: 0.4;
      z-index: 0;
    }
    #screen-shop > * {
      position: relative;
      z-index: 1;
    }

    /* === [NEW] QA SCREEN - CYBER THEME === */
    #screen-qa {
      background: linear-gradient(135deg, #020a02 0%, #0a1f0a 50%, #051005 100%);
      overflow: hidden;
      justify-content: flex-start;
      padding-top: 0;
    }
    #screen-qa::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background:
        linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px),
        linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px);
      background-size: 40px 40px;
      animation: gridMove 20s linear infinite;
      pointer-events: none;
      z-index: 0;
    }
    #screen-qa::after {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.15) 2px,
        rgba(0, 0, 0, 0.15) 4px
      );
      pointer-events: none;
      opacity: 0.4;
      z-index: 0;
    }
    #screen-qa > * {
      position: relative;
      z-index: 1;
    }

    /* === [NEW] SHOP/QA SCREEN HEADER === */
    #screen-shop .screen-header, #screen-qa .screen-header {
      position: relative;
      justify-content: space-between;
      align-items: center;
      background: rgba(0, 20, 0, 0.8);
      border-bottom: 1px solid rgba(0, 255, 65, 0.3);
      width: 100%;
      flex-shrink: 0;
      padding: 10px 12px;
    }
    #screen-shop .screen-header {
      margin-bottom: 12px;
    }
    .btn-back {
      background: none;
      border: none;
      color: #00ff41;
      font-size: 14px;
      font-weight: 800;
      cursor: pointer;
      padding: 6px 10px;
      text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
      z-index: 1;
    }
    .header-title {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-size: 18px;
      font-weight: 900;
      color: #00ff41;
      text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
    }
    .header-currency {
      gap: 8px;
      font-size: 11px;
      font-weight: 800;
      background: none;
      padding: 0;
      margin: 0;
      border: none;
      border-radius: 0;
      z-index: 1;
      display: flex;
      align-items: center;
      line-height: 1;
    }
    .header-currency .currency-item {
      font-size: 11px;
      gap: 3px;
      margin: 0;
      padding: 0;
      line-height: 1;
      display: flex;
      align-items: center;
    }
    .header-currency .currency-icon-sm {
      width: 14px;
      height: 14px;
      vertical-align: middle;
    }

    /* === [NEW] RESULT SCREEN === */
    #screen-result {
      justify-content: center;
      padding: 10px;
      padding-top: calc(10px + env(safe-area-inset-top, 0px));
      padding-bottom: calc(10px + env(safe-area-inset-bottom, 0px));
      overflow-y: auto;
      overflow-x: hidden;
    }
    .result-header {
      font-size: clamp(24px, 6vw, 32px);
      font-weight: 900;
      color: #e74c3c;
      text-shadow: 0 0 15px rgba(231, 76, 60, 0.5);
      margin-bottom: 8px;
      flex-shrink: 0;
    }
    #screen-result .result-card {
      width: 100%;
      max-width: 360px;
      margin: 0 auto;
      position: relative;
      padding: 40px 14px 14px 14px;
      flex-shrink: 0;
    }
    .result-footer {
      display: flex;
      gap: 10px;
      margin-top: 8px;
      flex-shrink: 0;
    }
    .result-btn {
      padding: 12px 24px;
      font-size: 15px;
      flex: 1;
      max-width: 150px;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    /* Skip Button - Compact */
    .result-skip-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: linear-gradient(135deg, rgba(52, 152, 219, 0.4), rgba(155, 89, 182, 0.4));
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.2s;
      z-index: 10;
      display: flex;
      align-items: center;
      gap: 4px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .result-skip-btn:hover {
      background: linear-gradient(135deg, rgba(52, 152, 219, 0.6), rgba(155, 89, 182, 0.6));
    }
    .result-skip-btn:active { transform: scale(0.95); }
    .result-skip-btn.hidden { display: none; }
    .skip-icon { font-size: 12px; }

    /* Score Breakdown Table - Compact */
    .result-breakdown {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 8px;
    }
    .breakdown-row {
      display: grid;
      grid-template-columns: 20px 52px 42px 36px 1fr;
      align-items: center;
      gap: 4px;
      padding: 6px 8px;
      background: rgba(0,0,0,0.3);
      border-radius: 6px;
      border: 1px solid transparent;
      opacity: 0.5;
      transition: all 0.25s ease-out;
    }
    .breakdown-row[data-status="active"] {
      opacity: 1;
      border-color: rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.06);
    }
    .breakdown-row[data-status="done"] {
      opacity: 1;
    }
    .breakdown-row.counting {
      animation: row-counting 0.1s linear infinite;
    }
    @keyframes row-counting {
      0%, 100% { background: rgba(255,255,255,0.06); }
      50% { background: rgba(255,255,255,0.1); }
    }
    .breakdown-icon img { width: 18px; height: 18px; object-fit: contain; }
    .breakdown-label { font-size: 10px; font-weight: 700; color: #95a5a6; text-transform: uppercase; }
    .breakdown-count { font-size: 12px; font-weight: 800; color: #fff; text-align: right; }
    .breakdown-mult { font-size: 9px; font-weight: 600; color: #7f8c8d; }
    .breakdown-score { font-size: 13px; font-weight: 900; text-align: right; }
    .score-green { color: #2ecc71; }
    .score-gold { color: #f1c40f; }
    .score-cyan { color: #00bcd4; }
    .score-white { color: #ecf0f1; }

    /* Divider */
    .result-divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
      margin: 8px 0;
    }

    /* Total Score Section with Rank - Compact */
    .result-total-section {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 6px;
    }
    .result-rank-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      min-width: 50px;
    }
    .rank-badge {
      width: 40px;
      height: 40px;
      border: 2px solid #95a5a6;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 22px;
      font-weight: 900;
      line-height: 0.8;
      text-align: center;
      color: #95a5a6;
      background: rgba(0,0,0,0.3);
      animation: rank-pop 0.4s ease-out;
    }
    @keyframes rank-pop {
      0% { transform: scale(0); opacity: 0; }
      60% { transform: scale(1.15); }
      100% { transform: scale(1); opacity: 1; }
    }
    .rank-label {
      font-size: 8px;
      font-weight: 800;
      color: #95a5a6;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }
    .result-total-row {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .result-title {
      font-size: 11px;
      color: #2ecc71;
      font-weight: 700;
    }

    /* Total Score */
    .result-total-value {
      font-size: clamp(22px, 6vw, 28px);
      color: #2ecc71;
      text-shadow: 0 0 12px rgba(46, 204, 113, 0.4);
      font-weight: 900;
    }
    .result-total-value.counting {
      animation: total-pulse 0.15s ease-in-out infinite;
    }
    @keyframes total-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.03); }
    }

    /* High Score Section - Compact */
    .result-highscore-section {
      margin: 6px 0;
      text-align: center;
    }
    .highscore-bar-container {
      margin-bottom: 4px;
    }
    .highscore-bar-bg {
      height: 8px;
      background: rgba(0,0,0,0.4);
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }
    .highscore-bar-fill {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #3498db, #2ecc71);
      border-radius: 4px;
      transition: width 0.8s ease-out;
    }
    .highscore-bar-current {
      position: absolute;
      top: -2px;
      width: 3px;
      height: 12px;
      background: #fff;
      border-radius: 2px;
      box-shadow: 0 0 6px rgba(255,255,255,0.8);
      transition: left 0.8s ease-out;
      left: 0%;
    }
    .highscore-labels {
      display: flex;
      justify-content: space-between;
      font-size: 9px;
      font-weight: 700;
      color: #7f8c8d;
      margin-top: 2px;
    }
    .badge-new {
      background: linear-gradient(90deg, #f1c40f, #e67e22);
      color: #000;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 900;
      box-shadow: 0 2px 8px rgba(241, 196, 15, 0.5);
      animation: badge-flash 0.5s ease-in-out infinite;
      display: inline-block;
      margin-top: 4px;
    }
    @keyframes badge-flash {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.85; transform: scale(1.03); }
    }

    /* Currency Row - Compact */
    .result-currency-row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      font-weight: 800;
      color: #ecf0f1;
      background: rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 8px;
      padding: 6px 8px;
      font-size: 12px;
      margin-bottom: 30px;
    }
    .result-stat {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .result-stat .currency-icon-sm {
      width: 14px;
      height: 14px;
    }

    /* Score Guide Button */
    .score-guide-btn {
      position: absolute;
      bottom: 8px;
      right: 8px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      color: #bdc3c7;
      font-size: 12px;
      font-weight: 900;
      cursor: pointer;
      transition: all 0.2s;
    }
    .score-guide-btn:hover { background: rgba(255,255,255,0.2); color: #fff; }

    /* Score Guide Popup */
    .score-guide-popup {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.92);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 200;
    }
    .score-guide-content {
      background: #2c3e50;
      padding: 20px;
      border-radius: 14px;
      width: 85%;
      max-width: 280px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .score-guide-header {
      font-size: 18px;
      font-weight: 900;
      color: #fff;
      text-align: center;
      margin-bottom: 12px;
    }
    .score-guide-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      font-weight: 700;
      font-size: 13px;
      color: #ecf0f1;
    }
    .score-guide-item:last-of-type { border-bottom: none; }
    .guide-icon { width: 20px; height: 20px; object-fit: contain; }
    .guide-value { margin-left: auto; color: #2ecc71; }
    .score-guide-content .btn-common { margin-top: 12px; width: 100%; padding: 10px; font-size: 14px; }

    /* === [NEW] PAUSE OVERLAY === */
    .overlay-popup {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.94); z-index: 150; /* darker to replace removed blur */
      display: flex; justify-content: center; align-items: center;
    }
    .pause-box {
      background: #2c3e50; padding: 30px 40px; border-radius: 20px;
      text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      border: 2px solid rgba(255,255,255,0.1);
    }
    .pause-title { font-size: 32px; font-weight: 900; color: #fff; margin-bottom: 25px; }
    .pause-btn { display: block; width: 100%; margin-bottom: 12px; padding: 14px 50px; font-size: 16px; }
    .pause-btn:last-child { margin-bottom: 0; }

    /* === [NEW] TREASURE LIST === */
    .treasure-item {
      background: rgba(0,0,0,0.25); padding: 14px; margin-bottom: 10px; border-radius: 12px;
      display: flex; justify-content: space-between; align-items: center;
      border: 2px solid transparent;
    }
    .treasure-item.owned { border-color: #2ecc71; background: rgba(46, 204, 113, 0.1); }
    .treasure-item.equipped { border-color: #f1c40f; background: rgba(241, 196, 15, 0.15); }
    .treasure-info { display: flex; flex-direction: column; gap: 4px; }
    .treasure-name { font-size: 15px; font-weight: 800; color: #ecf0f1; }
    .treasure-icon { width: 18px; height: 18px; margin-right: 6px; vertical-align: -3px; }
    .treasure-desc { font-size: 12px; color: #bdc3c7; }
    .treasure-actions { display: flex; gap: 8px; }

    /* === [FIX] QA ?붾㈃ ?믪씠 ?쒗븳 ?댁젣 === */
    .qa-group {
      max-height: none !important;
      height: auto !important;
    }

/* === [MOBILE UI 議곗젙] - ?곗튂 ?붾컮?댁뒪 ?먮뒗 醫곸? ?붾㈃ === */
@media screen and (max-width: 768px), screen and (hover: none) and (pointer: coarse) {
  #target-display {
    top: calc(76px + env(safe-area-inset-top, 0px));
    /* 紐⑤컮?쇱뿉??80% ?ш린濡?異뺤냼 */
    width: 96px !important;   /* 120px * 0.8 */
    height: 96px !important;  /* 120px * 0.8 */
    border-width: 5px !important;  /* 6px * 0.8 */
  }
  #target-display #countdown-text.countdown-is-number {
    font-size: 42px !important;  /* 52px * 0.8 */
  }
  #target-display #countdown-text.countdown-is-text {
    font-size: 26px !important;  /* 32px * 0.8 */
  }
  #status-bar-container {
    top: calc(185px + env(safe-area-inset-top, 0px)); /* ?됱긽 ?⑤꼸 異뺤냼濡??꾩튂 議곗젙 */
  }
  #status-bar-container #phase-bar {
    width: 96px !important;  /* 120px * 0.8 */
  }
  #status-bar-container #status-msg {
    font-size: 90%;  /* ?쎄컙 異뺤냼 */
    padding: 5px 11px;  /* 6px 14px * 0.8 */
  }
  #toast-msg {
    top: calc(240px + env(safe-area-inset-top, 0px)); /* ?꾩튂 議곗젙 */
  }
}

/* === [WIDE SCREEN / TABLET ??? === */
@media screen and (min-width: 500px) {
  #screen-result {
    justify-content: center;
    padding: 20px;
  }
  #screen-result .result-card {
    max-width: 400px;
    padding: 45px 20px 20px 20px;
  }
  .breakdown-row {
    grid-template-columns: 24px 60px 50px 42px 1fr;
    padding: 8px 12px;
    gap: 6px;
  }
  .breakdown-icon img { width: 22px; height: 22px; }
  .breakdown-label { font-size: 11px; }
  .breakdown-count { font-size: 14px; }
  .breakdown-score { font-size: 15px; }
  .result-total-value { font-size: 30px; }
  .rank-badge { width: 48px; height: 48px; font-size: 26px; }
  .rank-label { font-size: 9px; }
  .result-btn { padding: 14px 30px; font-size: 16px; }
  .result-skip-btn { padding: 8px 14px; font-size: 12px; }
}

@media screen and (min-width: 768px) {
  #screen-result .result-card {
    max-width: 450px;
    padding: 50px 24px 24px 24px;
  }
  .breakdown-row {
    grid-template-columns: 28px 70px 55px 48px 1fr;
    padding: 10px 14px;
  }
  .breakdown-icon img { width: 24px; height: 24px; }
  .breakdown-label { font-size: 12px; }
  .breakdown-count { font-size: 15px; }
  .breakdown-score { font-size: 17px; }
  .result-total-value { font-size: 34px; }
  .rank-badge { width: 54px; height: 54px; font-size: 28px; border-width: 3px; }
  .rank-label { font-size: 10px; }
  .result-header { font-size: 38px; }
  .result-btn { padding: 16px 36px; font-size: 18px; max-width: 180px; }
}

/* ============================================
   RESULT SCREEN ENHANCED ANIMATIONS
   ============================================ */

/* === GLITCH TRANSITION OVERLAY === */
.glitch-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 999;
  opacity: 0;
  visibility: hidden;
}
.glitch-overlay.active {
  visibility: visible;
  animation: glitchFlash 0.4s ease-out forwards;
}
@keyframes glitchFlash {
  0% { opacity: 1; background: #fff; }
  10% { opacity: 0.8; background: #ff0040; }
  20% { opacity: 0.6; background: #00ff90; }
  30% { opacity: 0.4; background: #0080ff; }
  50% { opacity: 0.2; background: transparent; }
  100% { opacity: 0; visibility: hidden; }
}

/* Scanline effect - only visible when overlay is active */
.glitch-overlay::after {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.15) 2px,
    rgba(0, 0, 0, 0.15) 4px
  );
  opacity: 0;
}
.glitch-overlay.active::after {
  opacity: 0.5;
  animation: scanlineMove 0.1s linear infinite;
}
@keyframes scanlineMove {
  0% { transform: translateY(0); }
  100% { transform: translateY(4px); }
}

/* === GAME OVER HEADER GLITCH === */
.result-header.glitch-text {
  position: relative;
  animation: textGlitch 0.3s ease-out;
}
.result-header.glitch-text::before,
.result-header.glitch-text::after {
  content: 'GAME OVER';
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  opacity: 0.8;
}
.result-header.glitch-text::before {
  color: #ff0040;
  animation: glitchLeft 0.2s ease-out;
}
.result-header.glitch-text::after {
  color: #00ffff;
  animation: glitchRight 0.2s ease-out;
}
@keyframes glitchLeft {
  0%, 100% { transform: translateX(0); opacity: 0; }
  20% { transform: translateX(-3px); opacity: 0.8; }
  40% { transform: translateX(2px); opacity: 0.5; }
}
@keyframes glitchRight {
  0%, 100% { transform: translateX(0); opacity: 0; }
  20% { transform: translateX(3px); opacity: 0.8; }
  40% { transform: translateX(-2px); opacity: 0.5; }
}
@keyframes textGlitch {
  0% { opacity: 0; transform: scale(1.1); }
  30% { opacity: 1; transform: scale(1.02) skewX(-2deg); }
  60% { transform: scale(0.98) skewX(1deg); }
  100% { transform: scale(1) skewX(0); }
}

/* === CARD SLIDE-IN ANIMATION === */
.result-card.card-enter {
  animation: cardSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}
@keyframes cardSlideIn {
  0% {
    opacity: 0;
    transform: translateY(60px) rotateX(10deg) scale(0.95);
  }
  60% {
    opacity: 1;
    transform: translateY(-8px) rotateX(-2deg) scale(1.02);
  }
  100% {
    opacity: 1;
    transform: translateY(0) rotateX(0) scale(1);
  }
}

/* === ROW SLIDE-IN ANIMATION === */
.breakdown-row.row-enter {
  opacity: 0;
  transform: translateX(-30px);
}
.breakdown-row.row-animate {
  animation: rowSlideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}
@keyframes rowSlideIn {
  0% {
    opacity: 0;
    transform: translateX(-30px);
  }
  100% {
    opacity: 0.5;
    transform: translateX(0);
  }
}

/* Row active glow effect */
.breakdown-row[data-status="active"] {
  box-shadow: 0 0 12px rgba(46, 204, 113, 0.3), inset 0 0 8px rgba(46, 204, 113, 0.1);
  border-color: rgba(46, 204, 113, 0.4) !important;
}
.breakdown-row[data-status="active"].counting {
  animation: rowPulseGlow 0.15s ease-in-out infinite;
}
@keyframes rowPulseGlow {
  0%, 100% {
    box-shadow: 0 0 12px rgba(46, 204, 113, 0.3), inset 0 0 8px rgba(46, 204, 113, 0.1);
  }
  50% {
    box-shadow: 0 0 20px rgba(46, 204, 113, 0.5), inset 0 0 12px rgba(46, 204, 113, 0.2);
  }
}

/* Row completion flash */
.breakdown-row.row-complete {
  animation: rowCompleteFlash 0.3s ease-out;
}
@keyframes rowCompleteFlash {
  0% { background: rgba(46, 204, 113, 0.3); }
  100% { background: rgba(0, 0, 0, 0.3); }
}

/* === RANK BADGE ENHANCED EFFECTS === */
.rank-badge.rank-enter {
  animation: rankSpinIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}
@keyframes rankSpinIn {
  0% {
    opacity: 0;
    transform: scale(0) rotate(-180deg);
  }
  60% {
    opacity: 1;
    transform: scale(1.2) rotate(10deg);
  }
  100% {
    opacity: 1;
    transform: scale(1) rotate(0deg);
  }
}

/* Rank-specific glow effects */
.rank-badge.rank-s {
  border-color: #f1c40f !important;
  color: #f1c40f !important;
  background: radial-gradient(circle, rgba(241, 196, 15, 0.3), rgba(0,0,0,0.3)) !important;
  box-shadow: 0 0 20px rgba(241, 196, 15, 0.6), 0 0 40px rgba(241, 196, 15, 0.3);
  animation: rankSpinIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), rankSGlow 1.5s ease-in-out infinite 0.6s;
}
@keyframes rankSGlow {
  0%, 100% { box-shadow: 0 0 20px rgba(241, 196, 15, 0.6), 0 0 40px rgba(241, 196, 15, 0.3); }
  50% { box-shadow: 0 0 35px rgba(241, 196, 15, 0.8), 0 0 60px rgba(241, 196, 15, 0.5); }
}

.rank-badge.rank-a {
  border-color: #2ecc71 !important;
  color: #2ecc71 !important;
  background: radial-gradient(circle, rgba(46, 204, 113, 0.2), rgba(0,0,0,0.3)) !important;
  box-shadow: 0 0 15px rgba(46, 204, 113, 0.5);
}

.rank-badge.rank-b {
  border-color: #3498db !important;
  color: #3498db !important;
  background: radial-gradient(circle, rgba(52, 152, 219, 0.2), rgba(0,0,0,0.3)) !important;
  box-shadow: 0 0 12px rgba(52, 152, 219, 0.4);
}

.rank-badge.rank-c {
  border-color: #9b59b6 !important;
  color: #9b59b6 !important;
  background: radial-gradient(circle, rgba(155, 89, 182, 0.2), rgba(0,0,0,0.3)) !important;
}

.rank-badge.rank-d {
  border-color: #7f8c8d !important;
  color: #7f8c8d !important;
  animation: rankSpinIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), rankDGlitch 0.3s ease-out 0.6s;
}
@keyframes rankDGlitch {
  0%, 100% { transform: translateX(0); filter: none; }
  25% { transform: translateX(-2px); filter: hue-rotate(90deg); }
  75% { transform: translateX(2px); filter: hue-rotate(-90deg); }
}

/* === TOTAL SCORE ENHANCED ANIMATION === */
.result-total-value.total-enter {
  animation: totalScoreReveal 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}
@keyframes totalScoreReveal {
  0% {
    opacity: 0;
    transform: scale(0.5);
    filter: blur(10px);
  }
  60% {
    opacity: 1;
    transform: scale(1.15);
    filter: blur(0);
  }
  100% {
    transform: scale(1);
  }
}

.result-total-value.counting {
  animation: totalPulse 0.12s ease-in-out infinite;
  text-shadow: 0 0 20px rgba(46, 204, 113, 0.6);
}
@keyframes totalPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.04); }
}

/* === NEW RECORD ENHANCED CELEBRATION === */
.badge-new {
  display: inline-block;
  background: linear-gradient(135deg, #f1c40f 0%, #e67e22 50%, #f1c40f 100%);
  background-size: 200% 100%;
  color: #1a1a2e;
  padding: 6px 14px;
  border-radius: 20px;
  font-weight: 900;
  font-size: 13px;
  text-transform: uppercase;
  letter-spacing: 1px;
}
.badge-new.record-enter {
  animation: recordBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), recordShine 2s linear infinite 0.6s;
}
@keyframes recordBounce {
  0% {
    opacity: 0;
    transform: scale(0) rotate(-10deg);
  }
  50% {
    opacity: 1;
    transform: scale(1.3) rotate(5deg);
  }
  70% {
    transform: scale(0.9) rotate(-3deg);
  }
  100% {
    transform: scale(1) rotate(0);
  }
}
@keyframes recordShine {
  0% { background-position: 200% center; }
  100% { background-position: -200% center; }
}

/* Record celebration particles container */
.record-particles {
  position: absolute;
  top: 50%; left: 50%;
  width: 0; height: 0;
  pointer-events: none;
  z-index: 10;
}
.record-particle {
  position: absolute;
  width: 8px; height: 8px;
  border-radius: 50%;
  animation: particleBurst 1s ease-out forwards;
}
@keyframes particleBurst {
  0% {
    opacity: 1;
    transform: translate(0, 0) scale(1);
  }
  100% {
    opacity: 0;
    transform: translate(var(--tx), var(--ty)) scale(0);
  }
}

/* Confetti for new record */
.confetti-container {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  overflow: hidden;
  z-index: 200;
}
.confetti {
  position: absolute;
  width: 10px; height: 10px;
  opacity: 0;
  animation: confettiFall 3s ease-out forwards;
}
@keyframes confettiFall {
  0% {
    opacity: 1;
    transform: translateY(-20px) rotate(0deg);
  }
  100% {
    opacity: 0;
    transform: translateY(100vh) rotate(720deg);
  }
}

/* === HIGHSCORE BAR ENHANCED === */
.highscore-bar-fill {
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}
.highscore-bar-current {
  transition: left 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}
.highscore-bar-current.bar-enter {
  animation: barMarkerPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) 0.8s backwards;
}
@keyframes barMarkerPop {
  0% { transform: translateX(-50%) scale(0); }
  100% { transform: translateX(-50%) scale(1); }
}

/* Bar glow when passing high score */
.highscore-bar-fill.bar-exceeded {
  box-shadow: 0 0 15px rgba(46, 204, 113, 0.8);
  animation: barExceedPulse 0.5s ease-out;
}
@keyframes barExceedPulse {
  0% { box-shadow: 0 0 30px rgba(46, 204, 113, 1); }
  100% { box-shadow: 0 0 15px rgba(46, 204, 113, 0.8); }
}

/* === FOOTER BUTTONS ANIMATION === */
.result-footer.footer-enter .result-btn {
  opacity: 0;
  transform: translateY(20px);
  animation: footerBtnEnter 0.4s ease-out forwards;
}
.result-footer.footer-enter .result-btn:nth-child(1) { animation-delay: 0.1s; }
.result-footer.footer-enter .result-btn:nth-child(2) { animation-delay: 0.2s; }
@keyframes footerBtnEnter {
  0% {
    opacity: 0;
    transform: translateY(20px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

/* === S-RANK LEGENDARY FULLSCREEN EFFECT === */
.legendary-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 250;
  opacity: 0;
}
.legendary-overlay.active {
  animation: legendaryFlash 1s ease-out forwards;
}
@keyframes legendaryFlash {
  0% { opacity: 0; background: transparent; }
  15% { opacity: 1; background: rgba(241, 196, 15, 0.4); }
  30% { opacity: 0.6; background: rgba(241, 196, 15, 0.2); }
  100% { opacity: 0; background: transparent; }
}

/* Legendary sparkle particles */
.legendary-sparkle {
  position: absolute;
  width: 4px; height: 4px;
  background: #f1c40f;
  border-radius: 50%;
  box-shadow: 0 0 6px #f1c40f, 0 0 12px #f1c40f;
  animation: sparkleFade 1.5s ease-out forwards;
}
@keyframes sparkleFade {
  0% {
    opacity: 1;
    transform: scale(0);
  }
  20% {
    opacity: 1;
    transform: scale(1);
  }
  100% {
    opacity: 0;
    transform: scale(0.5) translateY(-30px);
  }
}

/* === MOBILE OPTIMIZATIONS === */
@media screen and (max-width: 768px), screen and (hover: none) {
  /* Faster animations on mobile */
  .result-card.card-enter {
    animation-duration: 0.35s;
  }
  .breakdown-row.row-animate {
    animation-duration: 0.25s;
  }
  .rank-badge.rank-enter {
    animation-duration: 0.4s;
  }

  /* Simpler glitch on mobile */
  .result-header.glitch-text::before,
  .result-header.glitch-text::after {
    display: none;
  }

  /* Reduce particle count handled in JS */
  .confetti {
    width: 8px; height: 8px;
  }

  /* Touch-friendly skip button */
  .result-skip-btn {
    min-width: 70px;
    min-height: 44px;
    padding: 10px 16px;
  }
}

/* === REDUCED MOTION SUPPORT === */
@media (prefers-reduced-motion: reduce) {
  .result-card.card-enter,
  .breakdown-row.row-animate,
  .rank-badge.rank-enter,
  .badge-new.record-enter,
  .result-total-value.total-enter,
  .glitch-overlay.active,
  .legendary-overlay.active {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
  }

  .rank-badge.rank-s,
  .breakdown-row[data-status="active"].counting,
  .result-total-value.counting {
    animation: none !important;
  }

  .confetti,
  .record-particle,
  .legendary-sparkle {
    display: none !important;
  }
}


