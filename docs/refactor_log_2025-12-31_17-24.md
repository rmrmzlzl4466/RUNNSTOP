# 튜토리얼 리팩토링 진행 기록 (2025-12-31 17:24)

## 작업 개요
- 목표: 튜토리얼 분기 로직을 루프에서 축소하고, 전이를 TutorialManager/Lifecycle로 위임하는 방향으로 1차 정리
- 범위: 튜토리얼 실패 처리(낙사/폭풍) 경로 및 루프 내 tutorial 분기

## 작업 내용
- `assets/js/game/loop.js`
  - `tutorialMode` 분기 내 retry 처리를 제거하고 `handlers.onDie` 반환값으로 처리
  - `TutorialManager.tick()` 호출을 튜토리얼 모드 여부와 무관하게 수행 (내부에서 isActive 체크)
  - `safe_judgment` 이벤트는 루프에서 항상 dispatch (TutorialManager가 비활성 시 무시)
- `assets/js/game/lifecycle.js`
  - `handleDeath`가 boolean을 반환하도록 변경
  - 튜토리얼 모드일 때는 `Tutorial.retryStep()` 호출 후 `true` 반환
  - 일반 플레이는 기존 흐름 유지 (`false` 반환)

## 결과 및 영향
- 루프가 튜토리얼 실패 전이를 직접 처리하지 않게 됨
- 사망 처리 흐름이 `onDie` 반환값을 통해 단일 경로로 정리됨
- 튜토리얼 활성/비활성 여부는 `TutorialManager` 내부 상태로 제어

## 체크 포인트
- 튜토리얼 중 낙사/폭풍 사망 시 리트라이 정상 동작
- 일반 플레이 사망 시 결과 화면 진입 정상 동작
- safe_judgment 카운팅이 기존과 동일하게 동작

## 변경 파일
- `assets/js/game/loop.js`
- `assets/js/game/lifecycle.js`
